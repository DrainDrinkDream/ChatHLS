#include "fir.h"

void fir (
  data_t *y,
  data_t x
  )
{
	static coef_t c[N] = {10, 11, 11, 8, 3, -3, -8, -11, -11, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -11, -11, -8, -3, 3, 8, 11, 11, 10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 8, 3, -3, -8, -11, -11, -10, -10, -10, -10, -10, -10, -10, -10, -11, -11, -8, -3, 3, 8, 11, 11, 10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 8, 3, -3, -8, -11, -11, -10, -10, -10, -10, -10, -10, -10, -10, -11, -11, -8, -3, 3, 8, 11, 11, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10};

	char i;
	static data_t Mem[N]={0};
#pragma HLS ARRAY_PARTITION variable=Mem complete
	acc_t result;

	result = 0;

#pragma HLS PIPELINE
	for (i=N-1; i>=0; i--){
#pragma HLS UNROLL factor=4
		Mem[i] = Mem[i-1];
		result += Mem[i] * c[i];
	}

	Mem[0] = x;
	result += Mem[0] * c[0];
	*y = result;
}